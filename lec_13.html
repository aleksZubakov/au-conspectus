<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8">
<title>Конспект по алгоритмам. Минимальные остовные/покрывающие деревья (minimal spaning tree)</title>
<!-- Search Engine -->
<meta name="description" content="Минимальные остовные/покрывающие деревья (minimal spaning tree) Теорема о разрезе Пусть  T \subset M ,  M  -- MST ( T  -- остовный лес).  V = V_1 \sqcup V_">
<meta name="image" content="https://i.imgur.com/HunB6ar.jpg">
<!-- Schema.org for Google -->
<meta itemprop="name" content="Конспект по алгоритмам. Минимальные остовные/покрывающие деревья (minimal spaning tree)">
<meta itemprop="description" content="Минимальные остовные/покрывающие деревья (minimal spaning tree) Теорема о разрезе Пусть  T \subset M ,  M  -- MST ( T  -- остовный лес).  V = V_1 \sqcup V_">
<meta itemprop="image" content="https://i.imgur.com/HunB6ar.jpg">
<!-- Twitter -->
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Конспект по алгоритмам. Минимальные остовные/покрывающие деревья (minimal spaning tree)">
<meta name="twitter:description" content="Минимальные остовные/покрывающие деревья (minimal spaning tree) Теорема о разрезе Пусть  T \subset M ,  M  -- MST ( T  -- остовный лес).  V = V_1 \sqcup V_">
<meta name="twitter:image:src" content="https://i.imgur.com/HunB6ar.jpg">
<!-- Twitter - Article -->
<!-- Open Graph general (Facebook, Pinterest & Google+) -->
<meta property="og:title" content="Конспект по алгоритмам. Минимальные остовные/покрывающие деревья (minimal spaning tree)">
<meta property="og:description" content="Минимальные остовные/покрывающие деревья (minimal spaning tree) Теорема о разрезе Пусть  T \subset M ,  M  -- MST ( T  -- остовный лес).  V = V_1 \sqcup V_">
<meta property="og:image" content="https://i.imgur.com/HunB6ar.jpg">
<meta property="og:type" content="article">
<!-- Open Graph - Article -->

<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="assets/style.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/python.min.js" integrity="sha256-MRn7pN9LOBMrkp+8F2t5xb/92V1irzXp/dl5tUTwEgE=" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github-gist.min.css" integrity="sha256-tAflq+ymku3Khs+I/WcAneIlafYgDiOQ9stIHH985Wo=" crossorigin="anonymous" />
<script src="assets/xpath.js" type="text/javascript"></script>
<script>newIssue="https://github.com/demiurg906/au-conspectus/issues/new"</script>
<script src="assets/load.js"></script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax:    {
    inlineMath:  [['$','$'],  ['\\(','\\)']],
    displayMath: [["$$","$$"],["\\[","\\]"]],
    displayAlign: "center"
    // processEscapes: true
  },
  CommonHTML: { linebreaks: { automatic: true } },
  "HTML-CSS": { linebreaks: { automatic: true } },
         SVG: { linebreaks: { automatic: true } }
});
</script>
<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_CHTML">
</script>
</head>
<body>
  <div id="mistake">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 402.938 402.938"><path d="M401.785 33.437C399.28 18.683 389.61 16.48 384.07 16.48c-22.935 0-65.053 36.684-109.644 75.52-18.23 15.88-37.083 32.3-53.502 45.048-5.858 4.548-11.803 9.103-18.097 13.924-31.276 23.96-66.726 51.12-94.16 80.356-26.887 28.65-42.593 55.62-47.676 81.98L4.12 364.683c-5.122 4.628-5.523 12.532-.896 17.655 2.468 2.732 5.867 4.12 9.28 4.12 2.987 0 5.984-1.063 8.375-3.223l47.816-43.194c2.31.634 5.016.963 8.19.963 27.39 0 93.534-24.866 153.857-57.84l6.043-3.305L226.11 269.8l17.888 5.932 1.947-1.13c15.867-9.21 30.165-18.41 42.496-27.338 2.19-1.586 4.45-3.292 7.115-5.372l3.87-3.02-11.223-14.93 20.26 7.21 2.218-2.02c15.51-14.13 29.805-30.467 42.486-48.554l2.428-3.462-18.606-18.342 25.257 8.17 2.054-3.37c28.307-46.454 43.02-97.535 37.485-130.137z"/></svg>
  </div>

  <article class="content">
      
      <div class="navigation">
        <a href="https://demiurg906.github.io/au-conspectus/lec_12.html">← взад</a>
        <a href="index.html">на главную</a>
        <a href="https://demiurg906.github.io/au-conspectus/lec_14.html">вперёд →</a>
      </div>
      
      <h2 id="Минимальные-остовныепокрывающие-деревья-minimal-spaning-tree"><a aria-hidden="true" href="#Минимальные-остовныепокрывающие-деревья-minimal-spaning-tree"><span class="icon icon-link"></span></a>Минимальные остовные/покрывающие деревья (minimal spaning tree)</h2>
<h3 id="Теорема-о-разрезе"><a aria-hidden="true" href="#Теорема-о-разрезе"><span class="icon icon-link"></span></a>Теорема о разрезе</h3>
<p>Пусть <span class="inlineMath">$T \subset M$</span>, <span class="inlineMath">$M$</span> -- MST (<span class="inlineMath">$T$</span> -- остовный лес). <span class="inlineMath">$V = V_1 \sqcup V_2$</span> -- разрез <span class="inlineMath">$T$</span>, не пересекающий ребер <span class="inlineMath">$T$</span>.</p>
<p><strong>Утверждение:</strong> пусть <span class="inlineMath">$e$</span> -- минимальное ребро, пересекающее разрез. <span class="inlineMath">$T\cup \{e\} \subset M'$</span>, <span class="inlineMath">$M'$</span> -- тоже MST.</p>
<p><strong>Доказательство:</strong> Рассмотрим <span class="inlineMath">$M$</span>, <span class="inlineMath">$e\notin M$</span>. Пусть <span class="inlineMath">$H = M\cup \{e\}$</span>. В <span class="inlineMath">$H$</span> есть цикл (т.к. <span class="inlineMath">$M$</span> это уже остовное дерево) <span class="inlineMath">$\Rightarrow \exists e'$</span>, ребро, пересекающее разрез. <span class="inlineMath">$\omega(e) \leq \omega(e') \Rightarrow$</span> если выкинуть из дерева <span class="inlineMath">$e'$</span> и добавить <span class="inlineMath">$e$</span>, мы либо получим дерево такого же веса (что хорошо), либо получим дерево веса меньше, чем у минимального остовного (это значит, что нет минимальных остовных деревьев, которым не принадлежит <span class="inlineMath">$e'$</span>)</p>
<h3 id="Алгоритм-Прима"><a aria-hidden="true" href="#Алгоритм-Прима"><span class="icon icon-link"></span></a>Алгоритм Прима</h3>
<p>Берем минимальное ребро. Дальше на каждом шаге мы к уже готовому дереву добавляем ребро, смежное с этим деревом.</p>
<p>Т.к. дерево покрывает все вершины, можно начать с дерева, содержащего только одну вершину (e.g. первую), и начать растить дерево с него.</p>
<p>По сути, Дейкстра с другой метрикой.</p>
<pre><code class="language-python">def prim():
    dist = [inf for _ in range(n)]
    prev = [0 for _ in range(n)]

    pq = priority_queue()
    # пара (вершина, дистанция (вес мин. ребра))
    pq.insert((0, 0))
    while len(pq) > 0:
        v, d = q.extract_min()
        for u, w in g[v]:
            if dist[u] == inf:
                dist[u] = w
                prev[u] = v
                pq.insert(u, w)
            elif dist[u] > w:
                dist[u] = w
                prev[u] = v
                pq.decrease_key(u, w)

    T = ... # итоговое дерево
    for v in range(1, n):
        T += (prev[v], v)

    return T
</code></pre>
<p><strong>Сложность алгоритма:</strong> такая же, как и у Дейкстры:
1. <span class="inlineMath">$O(V^2)$</span> -- очередь на массиве
2. <span class="inlineMath">$O(V+E\log(V))$</span> -- очередь на бинарной куче
3. <span class="inlineMath">$O(E)$</span>, если <span class="inlineMath">$E\sim V^{1+\varepsilon}$</span> -- очередь на d-ичной куче.</p>
<h3 id="Алгоритм-Краскала"><a aria-hidden="true" href="#Алгоритм-Краскала"><span class="icon icon-link"></span></a>Алгоритм Краскала</h3>
<p>Изначально есть остовный лес из <span class="inlineMath">$n$</span> вершин, без ребер. Растим его, на каждом шаге добавляя ребро с минимальным весом, концы которого лежат в разных деревьях.</p>
<p>Используем <a class="term">систему непересекающихся множеств</a>, описание <code>make_set</code>, <code>find</code> и <code>union</code> см. ниже.</p>
<pre><code class="language-python">def kruskal():
    es.sort(key=lambda e: e.w)  # es -- множество ребер
    for v in range(n):
         make_set(v)
    T = ...  # пустое дерево
    for e in es:
        s1 = find(e.v)
        s2 = find(e.u)
        if s1 != s2:
            union(s1, s2)
            T += e

    return T
</code></pre>
<p><strong>Сложность алгоритма:</strong> если веса ребер из целочисленного диапазона, то отсортировать их за <span class="inlineMath">$O(E)$</span>, также ребра могут быть заранее отсортированы. В таком случае алгоритм будет работать за <span class="inlineMath">$O(V + E\log^* V)$</span></p>
<script>
var terms = {"\u0441\u0438\u0441\u0442\u0435\u043c\u0443 \u043d\u0435\u043f\u0435\u0440\u0435\u0441\u0435\u043a\u0430\u044e\u0449\u0438\u0445\u0441\u044f \u043c\u043d\u043e\u0436\u0435\u0441\u0442\u0432": {"wiki": {"title": "\u0421\u0438\u0441\u0442\u0435\u043c\u0430 \u043d\u0435\u043f\u0435\u0440\u0435\u0441\u0435\u043a\u0430\u044e\u0449\u0438\u0445\u0441\u044f \u043c\u043d\u043e\u0436\u0435\u0441\u0442\u0432", "extract": "\u0421\u0438\u0441\u0442\u0435\u043c\u0430 \u043d\u0435\u043f\u0435\u0440\u0435\u0441\u0435\u043a\u0430\u044e\u0449\u0438\u0445\u0441\u044f \u043c\u043d\u043e\u0436\u0435\u0441\u0442\u0432 (\u0430\u043d\u0433\u043b.\u00a0disjoint-set, \u0438\u043b\u0438 union\u2013find data structure)\u00a0\u2014 \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 \u0434\u0430\u043d\u043d\u044b\u0445, \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043c\u043d\u043e\u0436\u0435\u0441\u0442\u0432\u043e \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u043e\u0432, \u0440\u0430\u0437\u0431\u0438\u0442\u043e\u0435 \u043d\u0430 \u043d\u0435\u043f\u0435\u0440\u0435\u0441\u0435\u043a\u0430\u044e\u0449\u0438\u0435\u0441\u044f \u043f\u043e\u0434\u043c\u043d\u043e\u0436\u0435\u0441\u0442\u0432\u0430. \u041f\u0440\u0438 \u044d\u0442\u043e\u043c \u043a\u0430\u0436\u0434\u043e\u043c\u0443 \u043f\u043e\u0434\u043c\u043d\u043e\u0436\u0435\u0441\u0442\u0432\u0443 \u043d\u0430\u0437\u043d\u0430\u0447\u0430\u0435\u0442\u0441\u044f \u0435\u0433\u043e \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u0438\u0442\u0435\u043b\u044c\u00a0\u2014 \u044d\u043b\u0435\u043c\u0435\u043d\u0442 \u044d\u0442\u043e\u0433\u043e \u043f\u043e\u0434\u043c\u043d\u043e\u0436\u0435\u0441\u0442\u0432\u0430.", "extract_html": "<p><b>\u0421\u0438\u0441\u0442\u0435\u043c\u0430 \u043d\u0435\u043f\u0435\u0440\u0435\u0441\u0435\u043a\u0430\u044e\u0449\u0438\u0445\u0441\u044f \u043c\u043d\u043e\u0436\u0435\u0441\u0442\u0432</b> (\u0430\u043d\u0433\u043b.\u00a0<span lang=\"en\" xml:lang=\"en\">disjoint-set</span>, \u0438\u043b\u0438 <span lang=\"en\" xml:lang=\"en\">union\u2013find</span> <span lang=\"en\" xml:lang=\"en\">data structure</span>)\u00a0\u2014 \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 \u0434\u0430\u043d\u043d\u044b\u0445, \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043c\u043d\u043e\u0436\u0435\u0441\u0442\u0432\u043e \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u043e\u0432, \u0440\u0430\u0437\u0431\u0438\u0442\u043e\u0435 \u043d\u0430 \u043d\u0435\u043f\u0435\u0440\u0435\u0441\u0435\u043a\u0430\u044e\u0449\u0438\u0435\u0441\u044f \u043f\u043e\u0434\u043c\u043d\u043e\u0436\u0435\u0441\u0442\u0432\u0430. \u041f\u0440\u0438 \u044d\u0442\u043e\u043c \u043a\u0430\u0436\u0434\u043e\u043c\u0443 \u043f\u043e\u0434\u043c\u043d\u043e\u0436\u0435\u0441\u0442\u0432\u0443 \u043d\u0430\u0437\u043d\u0430\u0447\u0430\u0435\u0442\u0441\u044f \u0435\u0433\u043e \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u0438\u0442\u0435\u043b\u044c\u00a0\u2014 \u044d\u043b\u0435\u043c\u0435\u043d\u0442 \u044d\u0442\u043e\u0433\u043e \u043f\u043e\u0434\u043c\u043d\u043e\u0436\u0435\u0441\u0442\u0432\u0430.", "wiki_url": "https://ru.wikipedia.org/wiki/%D0%A1%D0%B8%D1%81%D1%82%D0%B5%D0%BC%D0%B0_%D0%BD%D0%B5%D0%BF%D0%B5%D1%80%D0%B5%D1%81%D0%B5%D0%BA%D0%B0%D1%8E%D1%89%D0%B8%D1%85%D1%81%D1%8F_%D0%BC%D0%BD%D0%BE%D0%B6%D0%B5%D1%81%D1%82%D0%B2"}, "neerc": {"title": "\u0422\u0440\u0438 \u043e\u0441\u043d\u043e\u0432\u043d\u044b\u0445 \u0442\u0435\u043e\u0440\u0435\u043c\u044b \u043e \u043f\u0440\u0435\u0434\u0435\u043b\u0430\u0445", "wiki_url": "https://neerc.ifmo.ru/wiki/index.php?title=%D0%A2%D1%80%D0%B8_%D0%BE%D1%81%D0%BD%D0%BE%D0%B2%D0%BD%D1%8B%D1%85_%D1%82%D0%B5%D0%BE%D1%80%D0%B5%D0%BC%D1%8B_%D0%BE_%D0%BF%D1%80%D0%B5%D0%B4%D0%B5%D0%BB%D0%B0%D1%85", "extract": "== \u0422\u0435\u043e\u0440\u0435\u043c\u0430 \u0412\u0435\u0439\u0435\u0440\u0448\u0442\u0440\u0430\u0441\u0441\u0430 ==\n\u0412 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0435", "extract_html": "\t<p> \u0422\u0435\u043e\u0440\u0435\u043c\u0430 \u0412\u0435\u0439\u0435\u0440\u0448\u0442\u0440\u0430\u0441\u0441\u0430 <br />\n\u0412 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0435</p>"}}};
</script>

      
      <div class="navigation">
          <a href="https://demiurg906.github.io/au-conspectus/lec_12.html">← взад</a>
          <a href="index.html">на главную</a>
          <a href="https://demiurg906.github.io/au-conspectus/lec_14.html">вперёд →</a>
      </div>
      
  </article>
<script src="assets/popup.js"></script>
</body>
</html>