<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8">
<title>Главный</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="assets/style.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-alpha1/katex.min.css" integrity="sha384-8QOKbPtTFvh/lMY0qPVbXj9hDh+v8US0pD//FcoYFst2lCIf0BmT58+Heqj0IGyx" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-alpha1/katex.min.js" integrity="sha384-GR8SEkOO1rBN/jnOcQDFcFmwXAevSLx7/Io9Ps1rkxWp983ZIuUGfxivlF/5f5eJ" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-alpha1/contrib/auto-render.min.js" integrity="sha384-cXpztMJlr2xFXyDSIfRWYSMVCXZ9HeGXvzyKTYrn03rsMAlOtIQVzjty5ULbaP8L" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/python.min.js" integrity="sha256-MRn7pN9LOBMrkp+8F2t5xb/92V1irzXp/dl5tUTwEgE=" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github-gist.min.css" integrity="sha256-tAflq+ymku3Khs+I/WcAneIlafYgDiOQ9stIHH985Wo=" crossorigin="anonymous" />
<script src="assets/xpath.js" type="text/javascript"></script>
<script>
window.onload = e => {
  renderMathInElement(document.body, {
    throwOnError: false,
    delimiters: [
      {left: "$$", right: "$$", display: true},
      {left: "\\[", right: "\\]", display: true},
      {left: "$", right: "$", display: false},
      {left: "\\(", right: "\\)", display: false}
    ]
  })

  hljs.initHighlighting()

  // document.getElementById(h).scrollIntoView()

  document.onmouseup = e => {
    r = window.getSelection();
    if (r.toString().rangeCount < 2) return;

    var $button = document.querySelector('#mistake')
    $button.style.display = 'block'

    var rect = r.getRangeAt(0).getBoundingClientRect();
    var relative = document.body.parentNode.getBoundingClientRect();
    $button.style.top   = `${r.bottom}px`;
    $button.style.right = `${r.right}px`;
    $button.style.opacity = 1

    var path = getElementXpath(r.anchorNode.parentNode);
    var msg = `Ребят, кажется у вас [ошибка](${location.href.replace(location.href, '')}?p=${encodeURIComponent(path)}) в фразе \`${r.toString()}\`, в параграфе:\n> ${r.anchorNode.parentNode.innerText}\n\n`;
    var title = `Ошибка в конспекте`
    var link = `https://github.com/xamgore/au-conspectus/issues/new?title=${encodeURIComponent(title)}&body=${encodeURIComponent(msg)}`;
  }

  // document.getElementById(h).scrollIntoView();
  // return document.evaluate(xpath, document, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue;
};
</script>
</head>
<body>
  <!-- <section class="toc">
    {{ toc }}
  </section> -->

  <div id="mistake"></div>

  <article class="content">
    {{ content }}
  </article>
<script src="assets/popup.js"></script>
</body>
</html>
